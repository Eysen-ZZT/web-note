### 打开小程序作了哪些事？

1. 初始化init  --  canIUse 赋值支持使用信息 --  获取系统信息getSystemInfoSync
2. 更新程序 tt.getUpdateManager()：此方法可以让用户主动更新小程序版本，该方法会返回一个 UpdateManager对象，调用 UpdateManager.applyUpdate会强制当前小程序应用新版本并重启。 UpdateManager.onCheckForUpdate此方法会向后台请求完整版本信息
3. 判断是否登录，检查 本地缓存是否有 globalOpenId， globalToken， globalRefreshToken这三个值，如果有 isLogin【是否登录】=true；isXCXParams【小程序初始化参数是否初始化】=true
4. 调用初始化接口，执行asyncInit方法，isInitLogin【是否正在初始化】，调用接口前设置为true，接口调用完毕初始化完成，设置为false。方法内依次调用 init， initOceanProgram， initUser这三个接口，调用init接口主要做了一些返回数据的赋值操作，调用 initOceanProgram接口，传递了onLaunch的参数option，并在方法中对传入的的option参数做格式化处理，并将处理好之后的参数对象存入本地 【key】globalXCXInitDataHistory，然后在从本地取出openid，若存在，直接作为该接口的入参，若不存在，调用tt.login()执行登录，获取code，anonymousCode作为入参。接口请求成功将第三点所涉及到的本地缓存数据存入对应的 key 中，同时涉及的另外两个值设为true。最后调用获取用户数据 initUser 接口，调用成功将返回数据存入本地 globalUserInfo 的key中，该函数传入两个参数，callback，ifReset，当ifReset为true时，获取页面数据信息，调用页面实例方法initData，这方法主要是获取观看历史记录。
5. 接下来是处理app的onShow，首先做了一个保持屏幕常亮的功能， 接下来是一个判断，判断初始化接口是否调用完毕以及option是否携带参数，如果已经初始化完毕并且有携带参数，进入判断，对参数格式化，如果参数为空对象，退出判断，反之，获取本地存入的 globalXCXInitDataHistory数据，然后将这个数据与格式化之后的数据进行判等，如果对象内属性全部相等，isEqual设为true，反之false，或者本地取出来的数据没有，也设为false，当isEqual为false的时候，将格式化的数据存入本地 globalXCXInitDataHistory的key中，同时isInitLogin设为true，开始初始化 initOceanProgram 接口，执行该接口的函数有一个callback参数，第4点中三个接口都有callback参数，在调完接口之后执行callback回调函数，函数内：获取当前页面实例，同时从格式化参数数据内取出ablumId【tt_ album_id 】，episodesId【tt_ episodes_id 】，epispdeNum【也就是seq】，id【id || bookid || album_id】，然后判断当前页是哪一个页面，根据页面执行页面对应的方法，并将刚取出数据作为参数传入方法。如果没有找到对应的页面，则进入else判断，这里面会根据系统是否能使用最新播放器来进行对应页面跳转。
6. 进入页面【page】级onLoad，这里主要做了初始化页面数据的操作，判断用户是否登录&&短剧列表是否小于1，如果已登录且小于1，进行初始化数据，反之，倒计时50秒，如果用户未登录状态且列表小于1，提示网络错误。初始化数据调用 v2/getRecom获取短剧列表，如果code!=200，提示网络错误，反之，同样是做一些赋值操作，然后在判断isFirstHome【猜测应该是主页的意思，默认值false】，判断的时候使用的是!isFirstHome，说明当前页面是主页，然后进行了页面宽度适配的初始化操作
7. 然后进入页面级onShow，第一步设置了导航栏标题，然后通过本地缓存获取到当前播放视频信息【 globalAtPlayletSuccess 】，这里主要是用于渲染当前播放剧集浮窗。
